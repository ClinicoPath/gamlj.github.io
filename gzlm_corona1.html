<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="(Marcello Gallucci)" />


<title>GzLM: Polynomial Gamma regression for coronavirus data</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110344212-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110344212-1');
</script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">GAMLj</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="glm.html">GLM</a>
</li>
<li>
  <a href="mixed.html">Mixed</a>
</li>
<li>
  <a href="gzlm.html">Generalized Models</a>
</li>
<li>
  <a href="gzlmmixed.html">Generalized Mixed Models</a>
</li>
<li>
  <a href="examples.html">Examples</a>
</li>
<li>
  <a href="rosetta.html">Rosetta store</a>
</li>
<li>
  <a href="release_notes.html">Release notes</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/gamlj/gamlj">View on Github</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">GzLM: Polynomial Gamma regression for coronavirus data</h1>
<h4 class="author">(Marcello Gallucci)</h4>

</div>


<p>```</p>
<p><span class="keywords"> <span class="keytitle"> keywords </span> Polynomial regression, Gamma distribution, Generalized linear model </span></p>
<p><span class="draft"> Draft version, mistakes may be around </span></p>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In this section we look at how to model cumulative distributions over time with the Generalized Linear Model. There are many different ways to model this kind of data, but the purpose here is to show how easy and flexible the generalized linear model is. With <span class="jamovi">jamovi</span> GAMLj things get very easy.</p>
<p>We are going to use the data from the recent <em>coronavirus</em> (COVID-19) outbreak, available at <a href="https://github.com/CSSEGISandData/COVID-19">CSSEGISandData</a>. Data are updated every day, at the moment ranging from 01-22-2020 to 03-09-2020. As new data arrive, results may change. Data are from different countries. Here we consider only countries where confirmed cases times number of days provides more than 1000 data points, so we can fit more robust models.</p>
<p><em>Please note that no medical or policy-making conclusions should be drawn from these analyses. The only purpose of this page is to show how the Generalized Linear Model may help in understanding some non-linear distributions of data. Here we use the data only to show how the software and the models work. For medical interpretation of the data please look for other sources where these data are analyzed for mediacal purposes and interpreted by medical scientists</em>.</p>
</div>
<div id="cumulative-distributions" class="section level1">
<h1>Cumulative distributions</h1>
<p>The <em>coronavirus</em> data available to us are in the form of number of confirmed cases for each day. So, each day accumulates also the previous days confirmed cases. Because the outbreak is recent (today is 2020-03-10), we have that the majority of days in several countries show very few cases, whereas a small number of days are associated with many cases. Here is the histogram for Italy and France data (Figure 1).</p>
<figure>
<figcaption>
Figure 1. Distribution of confirmed cases for two countries
</figcaption>
<img src="gzlm_corona1_files/figure-html/fig1-1.png">
</figure>
A gamma distribution shape depends on the <em>shape</em> parameter and the <em>rate</em> parameter, an example with small shape and rate is in Figure 2.
<figure>
<figcaption>
Figure 2. Theoretical gamma distributions
</figcaption>
<img src="gzlm_corona1_files/figure-html/fig2-1.png">
</figure>
<p>This distribution can be accomodated with a <em>Poisson distribution</em> or a <em>Gamma distribution</em>. Even though Gamma is a continuous distribution (and number of confirmed cases is not), preliminary analyses showed that the models fits better assuming it, so we will go for it.</p>
<p>Please note: because we want to model how the dependent variable changes over time, which is the main goal of the analysis, we are not going to deal with the inferential tests associated with the parameter estimates, so the assumed distribution is not crucial here, as long as the model fit. The same applies to the autocorrelation of the data, which is not a concern for our purposes.</p>
</div>
<div id="the-model" class="section level1">
<h1>The model</h1>
<p>The actual trend of the dependent variable over time may take different shapes. At the onset of the contagion phase, the trend of increase is typically exponential. An example is in Figure 3, in which the Italian data from day 10 (when the first Italian case was confirmed) to day 40 (the end of the fourth week after the Italian outbreak) are depicted.</p>
<figure>
<figcaption>
Figure 3. Confirmed by day for Italy, first 30 days
</figcaption>
<img src="gzlm_corona1_files/figure-html/fig3-1.png">
</figure>
<p>This shape can be easely captured with a logarithm link-function. That is, the model would simple look like: <span class="math display">\[ \hat{ln(y)}=a+b_1 \cdot x\]</span></p>
<p>Fitting a linear model like this one would produce predicted values expressed a <span class="math inline">\(ln(y)\)</span>. When we transform them back into the original scale, we obtain an exponential relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span>. Let’s do it in <span class="jamovi">jamovi</span>.</p>
</div>
<div id="simple-generalized-linear-model" class="section level1">
<h1>Simple generalized linear model</h1>
<div id="input" class="section level2">
<h2>Input</h2>
<p>As an example, let’s fit a GzLM as discussed above. We are going to use GAMLj <code>Generalized Linear Model</code> command.</p>
<p><img src="examples/corona/input.menu.png" class="img-responsive" alt=""></p>
<p>In the input panel, we need to select a <code>custom model</code>, because we need to set the <code>Gamma</code> as the DV distribution and the <code>Log</code> as the link function.</p>
<p><img src="examples/corona/input.model.png" class="img-responsive" alt=""></p>
<p>When we have done that, we just set the dependent and the independent variable (covariate) and we have done. To visualize the model, we go to the <code>Plot</code> panel and we select <code>Day</code> as the x-axis variable.</p>
<p><img src="examples/corona/input.plot.png" class="img-responsive" alt=""></p>
</div>
<div id="output" class="section level2">
<h2>Output</h2>
As we can see in the recap info table, the <span class="math inline">\(R^2\)</span> would be considered very good (&gt;.70)
<pre class='jamovitable'>
 Model Info                                                              
 ─────────────────────────────────────────────────────────────────────── 
   Info             Value      Comment                                   
 ─────────────────────────────────────────────────────────────────────── 
   Model Type       Custom     Model with custom family                  
   Call             glm        Confirmed ~ 1 + Day                       
   Link function    log        Coefficients are in the log(y) scale      
   Distribution     Gamma      Skewed continuous distribution            
   R-squared          0.795    Proportion of reduction of error          
   AIC              257.733    Less is better                            
   Deviance          34.463    Less is better                            
   Residual DF       29.000                                              
   Converged        yes        Whether the estimation found a solution   
 ─────────────────────────────────────────────────────────────────────── 

</pre>
<p>If we look at the plot and compared the predicted values (the curve) with the actual confirmed cases (cyan dots), we can see how the model fits reasonably well the data.</p>
<figure>
<figcaption>
Figure 4. Model for Italian first 30 days
</figcaption>
<img src="gzlm_corona1_files/figure-html/intro_plot1-1.png">
</figure>
<p>In many applications our results would be considered as satisfactory, but in this case we want to do better. First, it is clear that the confirmed cases increase at a faster rate that the predicted one. Second, the model will not work for long. The number of confirmed cases cannot increase exponentialy forever, so the model will start to grossly misfit, sooner or later. Let’s fit the same model (the input is equivalent so I’m not going to show it again) for the Mainland China data, in which the outbreak happened earlier than in Italy. For Mainland China, considering the first 40 days yealds very different results as compared with Italy.</p>
<figure>
<figcaption>
Figure 4. Simple model for Mainland China, first 40 days
</figcaption>
<img src="gzlm_corona1_files/figure-html/intro_plot2-1.png">
</figure>
<p>If we look at the plot and compared the predicted values (the curve) with the actual confirmed cases (cyan dots), we can see that the model does not really fit, and cannot fit the data well. We should allow the curve to bend down, or to smooth out, in order to follow the evolution of the DV over time.</p>
Furthermore, as we can see in the recap info table, the <span class="math inline">\(R^2\)</span> is definitely not good for this kind of applications (&lt;.70)
<pre class='jamovitable'>
 Model Info                                                               
 ──────────────────────────────────────────────────────────────────────── 
   Info             Value       Comment                                   
 ──────────────────────────────────────────────────────────────────────── 
   Model Type       Custom      Model with custom family                  
   Call             glm         Confirmed ~ 1 + Day                       
   Link function    log         Coefficients are in the log(y) scale      
   Distribution     Gamma       Skewed continuous distribution            
   R-squared           0.581    Proportion of reduction of error          
   AIC              1094.366    Less is better                            
   Deviance           21.667    Less is better                            
   Residual DF        46.000                                              
   Converged        yes         Whether the estimation found a solution   
 ──────────────────────────────────────────────────────────────────────── 

</pre>
<p>The solution is polynomial regression. In polynomial regression, one adds power terms (<span class="math inline">\(x^2\)</span>, <span class="math inline">\(x^3\)</span>, <span class="math inline">\(x^4\)</span> ..) in order to allow the curve to follow different paths along the time line. A squared term, for instance, allows the curve to stay flatter at the begining and stear up quickly. A cubic term allows the curve to smooth. The more polynomial terms one adds, more flexibility one allows to the curve shape.</p>
<p>For the present data, a polynomial regression up to the 4th grade can be enough (so far). Thus, the model is now:</p>
<p><span class="math display">\[ \hat{ln(y)}=a+b_1 \cdot x + b_2 \cdot x^2, b_3 \cdot x^3+b_4 \cdot x^4\]</span></p>
<p>We now review how to run this in <span class="jamovi">jamovi</span> GAMLj.</p>
</div>
</div>
<div id="polynomial-generalized-linear-model" class="section level1">
<h1>Polynomial Generalized Linear Model</h1>
<div id="input-1" class="section level2">
<h2>Input</h2>
<p>In the input panel of GAMLj, we need to open the <code>Model</code> panel. In the <code>Components</code> fiels, upon selecting the variable <code>Day</code>, we can see a little <code>1</code> on its right.</p>
<p><img src="examples/corona/input.square.png" class="img-responsive" alt=""></p>
<p>That is the order of the term we want to include in the model. By clicking the little arrow up, we bring the order to <code>2</code>, and then drag the new term in the <code>Model Terms</code> fiels.</p>
<p>By repeating the operation for order 3 and 4, we obtained the desired model.</p>
<p><img src="examples/corona/input.full.png" class="img-responsive" alt=""></p>
</div>
</div>
<div id="output-1" class="section level1">
<h1>Output</h1>
<p>If we fit the polynomial generalized model on the data from Mainland Chine, we obtain a <span class="math inline">\(R^2\)</span> pretty close to 1, showing how well the model now fits the data. More clearly, the plot of the new model shows the flexibility of the GzLM in adjusting itself to the data trend.</p>
<pre class='jamovitable'>
 Model Info                                                                           
 ──────────────────────────────────────────────────────────────────────────────────── 
   Info             Value      Comment                                                
 ──────────────────────────────────────────────────────────────────────────────────── 
   Model Type       Custom     Model with custom family                               
   Call             glm        Confirmed ~ 1 + Day + I(Day^2) + I(Day^3) + I(Day^4)   
   Link function    log        Coefficients are in the log(y) scale                   
   Distribution     Gamma      Skewed continuous distribution                         
   R-squared          0.995    Proportion of reduction of error                       
   AIC              887.401    Less is better                                         
   Deviance           0.276    Less is better                                         
   Residual DF       43.000                                                           
   Converged        yes        Whether the estimation found a solution                
 ──────────────────────────────────────────────────────────────────────────────────── 

</pre>
<figure>
<figcaption>
Figure 4. Polynomial model for Mainland China data
</figcaption>
<img src="gzlm_corona1_files/figure-html/intro_plot3-1.png">
</figure>
<p>We can see that the model really works. But what about the Italian and French data, that were very different? Well, the model works for Italy and France as well, thanks to the model flexibility. Actually, it works well for all countries with available data. All <span class="math inline">\(R^2\)</span> are close to 1, and the predicted values are very close to the observed one. At this point, one can start working on these models and use them to extrapolate information, make comparisons, and do whaterver one usually do with statistical models.</p>
<p>The fit of the same model estimation (polynomial up to the 4th grade) is shown in the next section for all countries with more than 1000 data points.</p>
</div>
<div id="replications-across-countries" class="section level1">
<h1>Replications across countries</h1>
<p>Here are the models fitted for all available countries with more than 1000 data points. Data are update every day. The last update is 2020-03-10.</p>
<div id="australia" class="section level2">
<h2>Australia</h2>
<p><strong>R^2= 0.9853647 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-1.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                   
 ───────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower    Upper    z         p       
 ───────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)     -0.1726    0.66373     0.841    0.216    2.931    -0.260    0.795   
   Day              0.4039    0.12752     1.498    1.173    1.936     3.167    0.002   
   Day²            -0.0203    0.00814     0.980    0.964    0.995    -2.493    0.013   
   Day³            4.19e-4    2.08e-4     1.000    1.000    1.001     2.009    0.045   
   Day⁴           -2.69e-6    1.85e-6     1.000    1.000    1.000    -1.454    0.146   
 ───────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="france" class="section level2">
<h2>France</h2>
<p><strong>R^2= 0.9918116 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-2.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                      
 ──────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower      Upper    z         p        
 ──────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)    -3.77738    0.80041    0.0229    0.00437    0.101     -4.72    < .001   
   Day             1.16952    0.13822    3.2204    2.47976    4.265      8.46    < .001   
   Day²           -0.07738    0.00797    0.9255    0.91080    0.940     -9.71    < .001   
   Day³            0.00201    1.87e-4    1.0020    1.00165    1.002     10.72    < .001   
   Day⁴           -1.67e-5    1.54e-6    1.0000    0.99998    1.000    -10.86    < .001   
 ──────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="germany" class="section level2">
<h2>Germany</h2>
<p><strong>R^2= 0.9945446 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-3.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                         
 ─────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)     Lower      Upper      z         p        
 ─────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)    -9.89345     1.2804    5.05e-5    3.76e-6    5.70e-4     -7.73    < .001   
   Day             2.14554     0.1994      8.547      5.838     12.762     10.76    < .001   
   Day²           -0.12630     0.0107      0.881      0.863      0.900    -11.76    < .001   
   Day³            0.00300    2.40e-4      1.003      1.003      1.003     12.50    < .001   
   Day⁴           -2.40e-5    1.91e-6      1.000      1.000      1.000    -12.55    < .001   
 ─────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="hong-kong" class="section level2">
<h2>Hong Kong</h2>
<p><strong>R^2= 0.9906541 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-4.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                    
 ────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower    Upper    z          p       
 ────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)     0.70302    0.40349     2.020    0.881     4.29     1.7423    0.081   
   Day             0.20905    0.07700     1.233    1.064     1.44     2.7148    0.007   
   Day²           -0.00334    0.00494     0.997    0.987     1.01    -0.6752    0.500   
   Day³            1.51e-6    1.28e-4     1.000    1.000     1.00     0.0118    0.991   
   Day⁴            2.90e-7    1.15e-6     1.000    1.000     1.00     0.2524    0.801   
 ────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="iran" class="section level2">
<h2>Iran</h2>
<p><strong>R^2= 0.9988269 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-5.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                            
 ────────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate     SE          exp(B)      Lower       Upper       z        p       
 ────────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)    115.74779    47.62881    1.86e+50    8.65e +8    1.22e+90     2.43    0.015   
   Day            -12.29649     4.73831    4.57e -6    4.91e-10      0.0580    -2.60    0.009   
   Day²             0.46563     0.17570       1.593       1.123      2.2366     2.65    0.008   
   Day³            -0.00729     0.00288       0.993       0.987      0.9984    -2.53    0.011   
   Day⁴             4.08e-5     1.76e-5       1.000       1.000      1.0001     2.32    0.020   
 ────────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="italy" class="section level2">
<h2>Italy</h2>
<p><strong>R^2= 0.9981727 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-6.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                           
 ───────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)      Lower       Upper       z        p        
 ───────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)    30.23152     1.7657    1.35e+13    4.00e+11    4.13e+14     17.1    < .001   
   Day            -4.79820     0.2668     0.00824     0.00488      0.0139    -18.0    < .001   
   Day²            0.24313     0.0133     1.27523     1.24250      1.3092     18.2    < .001   
   Day³           -0.00475    2.74e-4     0.99526     0.99472      0.9958    -17.3    < .001   
   Day⁴            3.29e-5    2.01e-6     1.00003     1.00003      1.0000     16.4    < .001   
 ───────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="japan" class="section level2">
<h2>Japan</h2>
<p><strong>R^2= 0.9888098 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-7.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                   
 ───────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower    Upper    z        p        
 ───────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)      0.5057    0.35397     1.658    0.798    3.205     1.43     0.153   
   Day              0.2703    0.06502     1.310    1.158    1.495     4.16    < .001   
   Day²            -0.0104    0.00402     0.990    0.982    0.997    -2.58     0.010   
   Day³            2.65e-4    1.00e-4     1.000    1.000    1.000     2.65     0.008   
   Day⁴           -2.40e-6    8.70e-7     1.000    1.000    1.000    -2.76     0.006   
 ───────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="mainland-china" class="section level2">
<h2>Mainland China</h2>
<p><strong>R^2= 0.9957152 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-8.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                        
 ────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)     Lower      Upper      z        p        
 ────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)      5.7558    0.01726    316.027    305.494    326.878    333.5    < .001   
   Day              0.4752    0.00304      1.608      1.599      1.618    156.1    < .001   
   Day²            -0.0149    1.87e-4      0.985      0.985      0.986    -80.1    < .001   
   Day³            2.01e-4    4.71e-6      1.000      1.000      1.000     42.8    < .001   
   Day⁴           -9.64e-7    4.17e-8      1.000      1.000      1.000    -23.1    < .001   
 ────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="malaysia" class="section level2">
<h2>Malaysia</h2>
<p><strong>R^2= 0.9796269 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-9.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                    
 ────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower    Upper    z          p       
 ────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)       0.428    0.68060     1.534    0.379     5.49     0.6289    0.529   
   Day               0.176    0.12816     1.192    0.934     1.54     1.3730    0.170   
   Day²           -7.21e-4    0.00806     0.999    0.983     1.01    -0.0895    0.929   
   Day³           -1.64e-4    2.04e-4     1.000    0.999     1.00    -0.8026    0.422   
   Day⁴            2.97e-6    1.80e-6     1.000    1.000     1.00     1.6564    0.098   
 ────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="netherlands" class="section level2">
<h2>Netherlands</h2>
<p><strong>R^2= 0.9972888 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-10.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                             
 ─────────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate     SE          exp(B)      Lower       Upper        z        p       
 ─────────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)    -2470.980    2437.145       0.000       0.000          Inf    -1.01    0.311   
   Day              229.893     224.676    6.94e+99    8.34e-85    1.83e+301     1.02    0.306   
   Day²              -8.047       7.752    3.20e -4    3.74e-11       731.60    -1.04    0.299   
   Day³               0.126       0.119       1.134       0.906         1.45     1.06    0.290   
   Day⁴            -7.34e-4     6.80e-4       0.999       0.998         1.00    -1.08    0.280   
 ─────────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="others" class="section level2">
<h2>Others</h2>
<p><strong>R^2= 0.9839325 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-11.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                      
 ──────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower      Upper    z          p       
 ──────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)      -4.170     2.2698    0.0154    1.75e-4     1.28    -1.8373    0.066   
   Day               0.551     0.2896    1.7343      0.986     3.07     1.9012    0.057   
   Day²           -5.35e-4     0.0135    0.9995      0.973     1.03    -0.0397    0.968   
   Day³           -3.25e-4    2.72e-4    0.9997      0.999     1.00    -1.1983    0.231   
   Day⁴            4.06e-6    2.00e-6    1.0000      1.000     1.00     2.0266    0.043   
 ──────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="singapore" class="section level2">
<h2>Singapore</h2>
<p><strong>R^2= 0.9958832 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-12.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                   
 ───────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower    Upper    z         p       
 ───────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)     0.19261    0.44440     1.212    0.485     2.78     0.433    0.665   
   Day             0.26036    0.08078     1.297    1.113     1.53     3.223    0.001   
   Day²           -0.00288    0.00503     0.997    0.987     1.01    -0.572    0.567   
   Day³           -8.33e-5    1.27e-4     1.000    1.000     1.00    -0.653    0.513   
   Day⁴            1.55e-6    1.13e-6     1.000    1.000     1.00     1.370    0.171   
 ───────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="south-korea" class="section level2">
<h2>South Korea</h2>
<p><strong>R^2= 0.9947459 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-13.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                    
 ────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower    Upper     z        p        
 ────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)     2.18213    0.25273     8.865    5.270    14.222     8.63    < .001   
   Day            -0.16156    0.04709     0.851    0.777     0.935    -3.43    < .001   
   Day²            0.00746    0.00281     1.007    1.002     1.013     2.65     0.008   
   Day³            1.72e-4    6.60e-5     1.000    1.000     1.000     2.61     0.009   
   Day⁴           -4.11e-6    5.36e-7     1.000    1.000     1.000    -7.67    < .001   
 ────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="spain" class="section level2">
<h2>Spain</h2>
<p><strong>R^2= 0.9940261 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-14.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                        
 ────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower      Upper      z          p       
 ────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)      0.1375     4.4319     1.147    1.35e-4    5439.48     0.0310    0.975   
   Day              0.2159     0.6368     1.241      0.360       4.43     0.3391    0.735   
   Day²            -0.0271     0.0314     0.973      0.915       1.03    -0.8653    0.387   
   Day³            9.77e-4    6.46e-4     1.001      1.000       1.00     1.5129    0.130   
   Day⁴           -9.26e-6    4.78e-6     1.000      1.000       1.00    -1.9387    0.053   
 ────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="switzerland" class="section level2">
<h2>Switzerland</h2>
<p><strong>R^2= 0.9960657 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-15.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                             
 ─────────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate     SE          exp(B)      Lower       Upper        z        p       
 ─────────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)    -2132.403    998.1228       0.000       0.000    3.19e-113    -2.14    0.033   
   Day              201.326     93.8000    2.72e+87    6.12e+10    1.23e+171     2.15    0.032   
   Day²              -7.137      3.2969    7.95e -4    9.28e -7        0.399    -2.16    0.030   
   Day³               0.113      0.0514       1.119       1.016        1.243     2.19    0.028   
   Day⁴            -6.65e-4     2.99e-4       0.999       0.999        1.000    -2.22    0.026   
 ─────────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="taiwan" class="section level2">
<h2>Taiwan</h2>
<p><strong>R^2= 0.9901642 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-16.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                    
 ────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower    Upper    z         p        
 ────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)     -0.0805    0.45892     0.923    0.354    2.147    -0.175     0.861   
   Day              0.3869    0.09345     1.472    1.234    1.782     4.140    < .001   
   Day²            -0.0202    0.00630     0.980    0.968    0.992    -3.202     0.001   
   Day³            4.90e-4    1.69e-4     1.000    1.000    1.001     2.899     0.004   
   Day⁴           -4.22e-6    1.56e-6     1.000    1.000    1.000    -2.706     0.007   
 ────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="thailand" class="section level2">
<h2>Thailand</h2>
<p><strong>R^2= 0.9877488 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-17.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                   
 ───────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower    Upper    z        p        
 ───────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)      0.6696    0.33840     1.953    0.974    3.677     1.98     0.048   
   Day              0.3428    0.07091     1.409    1.231    1.626     4.83    < .001   
   Day²            -0.0156    0.00491     0.985    0.975    0.994    -3.17     0.002   
   Day³            3.13e-4    1.35e-4     1.000    1.000    1.001     2.32     0.020   
   Day⁴           -2.24e-6    1.27e-6     1.000    1.000    1.000    -1.77     0.077   
 ───────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="uk" class="section level2">
<h2>UK</h2>
<p><strong>R^2= 0.9917477 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-18.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                          
 ──────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate     SE         exp(B)     Lower       Upper      z        p        
 ──────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)    -14.40825     3.6238    5.53e-7    2.97e-10    4.56e-4    -3.98    < .001   
   Day              2.26517     0.5157      9.633       3.655     27.718     4.39    < .001   
   Day²            -0.11325     0.0260      0.893       0.847      0.938    -4.36    < .001   
   Day³             0.00238    5.54e-4      1.002       1.001      1.004     4.30    < .001   
   Day⁴            -1.72e-5    4.25e-6      1.000       1.000      1.000    -4.04    < .001   
 ──────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="us" class="section level2">
<h2>US</h2>
<p><strong>R^2= 0.9920629 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-19.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                     
 ─────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower    Upper    z          p        
 ─────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)     -0.0170    0.45973     0.983    0.375    2.286    -0.0370     0.971   
   Day              0.3093    0.08785     1.363    1.154    1.630     3.5209    < .001   
   Day²            -0.0143    0.00554     0.986    0.975    0.996    -2.5904     0.010   
   Day³            3.00e-4    1.39e-4     1.000    1.000    1.001     2.1619     0.031   
   Day⁴           -1.60e-6    1.20e-6     1.000    1.000    1.000    -1.3317     0.183   
 ─────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
</div>
<div id="the-mixed-model" class="section level1">
<h1>The mixed model</h1>
<p>When enough contries are available, variability across coefficients, and thus differences in trends, can be evaluated with the mixed model. This will be done later on.</p>
</div>
<div id="data" class="section level1">
<h1>Data</h1>
<p>Here are the data downloaded from the <a href="https://github.com/CSSEGISandData/COVID-19">CSSEGISandData</a> and preprocessed to obtain the same results, divided by contries. You can import them in <span class="jamovi">jamovi</span> and exercise with them.</p>
<p><a href="/data/corona/data_Australia.csv">Australia</a></p>
<p><a href="/data/corona/data_France.csv">France</a></p>
<p><a href="/data/corona/data_Germany.csv">Germany</a></p>
<p><a href="/data/corona/data_Hong%20Kong.csv">Hong Kong</a></p>
<p><a href="/data/corona/data_Iran.csv">Iran</a></p>
<p><a href="/data/corona/data_Italy.csv">Italy</a></p>
<p><a href="/data/corona/data_Japan.csv">Japan</a></p>
<p><a href="/data/corona/data_Mainland%20China.csv">Mainland China</a></p>
<p><a href="/data/corona/data_Malaysia.csv">Malaysia</a></p>
<p><a href="/data/corona/data_Netherlands.csv">Netherlands</a></p>
<p><a href="/data/corona/data_Others.csv">Others</a></p>
<p><a href="/data/corona/data_Singapore.csv">Singapore</a></p>
<p><a href="/data/corona/data_South%20Korea.csv">South Korea</a></p>
<p><a href="/data/corona/data_Spain.csv">Spain</a></p>
<p><a href="/data/corona/data_Switzerland.csv">Switzerland</a></p>
<p><a href="/data/corona/data_Taiwan.csv">Taiwan</a></p>
<p><a href="/data/corona/data_Thailand.csv">Thailand</a></p>
<p><a href="/data/corona/data_UK.csv">UK</a></p>
<p><a href="/data/corona/data_US.csv">US</a></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
