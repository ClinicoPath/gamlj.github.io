<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="(Marcello Gallucci)" />


<title>GzLM: Polynomial Gamma regression for coronavirus data</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110344212-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110344212-1');
</script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">GAMLj</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="glm.html">GLM</a>
</li>
<li>
  <a href="mixed.html">Mixed</a>
</li>
<li>
  <a href="gzlm.html">Generalized Models</a>
</li>
<li>
  <a href="gzlmmixed.html">Generalized Mixed Models</a>
</li>
<li>
  <a href="examples.html">Examples</a>
</li>
<li>
  <a href="rosetta.html">Rosetta store</a>
</li>
<li>
  <a href="release_notes.html">Release notes</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/gamlj/gamlj">View on Github</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">GzLM: Polynomial Gamma regression for coronavirus data</h1>
<h4 class="author">(Marcello Gallucci)</h4>

</div>


<p>```</p>
<p><span class="keywords"> <span class="keytitle"> keywords </span> Polynomial regression, Gamma distribution, Generalized linear model </span></p>
<p><span class="draft"> Draft version, mistakes may be around </span></p>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In this section we look at how to model cumulative distributions over time with the Generalized Linear Model. There are many different ways to model this kind of data, but the purpose here is to show how easy and flexible the generalized linear model is. With <span class="jamovi">jamovi</span> GAMLj things get very easy.</p>
<p>We are going to use the data from the recent <em>coronavirus</em> (COVID-19) outbreak, available at <a href="https://github.com/CSSEGISandData/COVID-19">CSSEGISandData</a>. Data are updated every day, at the moment ranging from 01-22-2020 to 03-09-2020. As new data arrive, results may change. Data are from different countries. Here we consider only countries where confirmed cases times number of days provides more than 1000 data points, so we can fit more robust models.</p>
<p><em>Please note that no medical or policy-making conclusions should be drawn from these analyses. The only purpose of this page is to show how the Generalized Linear Model may help in understanding some non-linear distributions of data. Here we use the data only to show how the software and the models work. For medical interpretation of the data please look for other sources where these data are analyzed for mediacal purposes and interpreted by medical scientists</em>.</p>
</div>
<div id="cumulative-distributions" class="section level1">
<h1>Cumulative distributions</h1>
<p>The <em>coronavirus</em> data available to us are in the form of number of confirmed cases for each day. So, each day accumulates also the previous days confirmed cases. Because the outbreak is recent (today is 2020-03-10), we have that the majority of days in several countries show very few cases, whereas a small number of days are associated with many cases. Here is the histogram for Italy and France data (Figure 1).</p>
<figure>
<figcaption>
Figure 1. Distribution of confirmed cases for two countries
</figcaption>
<img src="gzlm_corona1_files/figure-html/fig1-1.png">
</figure>
A gamma distribution shape depends on the <em>shape</em> parameter and the <em>rate</em> parameter, an example with small shape and rate is in Figure 2.
<figure>
<figcaption>
Figure 2. Theoretical gamma distributions
</figcaption>
<img src="gzlm_corona1_files/figure-html/fig2-1.png">
</figure>
<p>This distribution can be accomodated with a <em>Poisson distribution</em> or a <em>Gamma distribution</em>. Even though Gamma is a continuous distribution (and number of confirmed cases is not), preliminary analyses showed that the models fits better assuming it, so we will go for it.</p>
<p>Please note: because we want to model how the dependent variable changes over time, which is the main goal of the analysis, we are not going to deal with the inferential tests associated with the parameter estimates, so the assumed distribution is not crucial here, as long as the model fit. The same applies to the autocorrelation of the data, which is not a concern for our purposes.</p>
</div>
<div id="the-model" class="section level1">
<h1>The model</h1>
<p>The actual trend of the dependent variable over time may take different shapes. At the onset of the contagion phase, the trend of increase is typically exponential. An example is in Figure 3, in which the Italian data from day 10 (when the first Italian case was confirmed) to day 40 (the end of the fourth week after the Italian outbreak) are depicted.</p>
<figure>
<figcaption>
Figure 3. Confirmed by day for Italy, first 30 days
</figcaption>
<img src="gzlm_corona1_files/figure-html/fig3-1.png">
</figure>
<p>This shape can be easely captured with a logarithm link-function. That is, the model would simple look like: <span class="math display">\[ \hat{ln(y)}=a+b_1 \cdot x\]</span></p>
<p>Fitting a linear model like this one would produce predicted values expressed a <span class="math inline">\(ln(y)\)</span>. When we transform them back into the original scale, we obtain an exponential relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span>. Let’s do it in <span class="jamovi">jamovi</span>.</p>
</div>
<div id="simple-generalized-linear-model" class="section level1">
<h1>Simple generalized linear model</h1>
<div id="input" class="section level2">
<h2>Input</h2>
<p>As an example, let’s fit a GzLM as discussed above. We are going to use GAMLj <code>Generalized Linear Model</code> command.</p>
<p><img src="examples/corona/input.menu.png" class="img-responsive" alt=""></p>
<p>In the input panel, we need to select a <code>custom model</code>, because we need to set the <code>Gamma</code> as the DV distribution and the <code>Log</code> as the link function.</p>
<p><img src="examples/corona/input.model.png" class="img-responsive" alt=""></p>
<p>When we have done that, we just set the dependent and the independent variable (covariate) and we have done. To visualize the model, we go to the <code>Plot</code> panel and we select <code>Day</code> as the x-axis variable.</p>
<p><img src="examples/corona/input.plot.png" class="img-responsive" alt=""></p>
</div>
<div id="output" class="section level2">
<h2>Output</h2>
As we can see in the recap info table, the <span class="math inline">\(R^2\)</span> would be considered very good (&gt;.70)
<pre class='jamovitable'>
 Model Info                                                              
 ─────────────────────────────────────────────────────────────────────── 
   Info             Value      Comment                                   
 ─────────────────────────────────────────────────────────────────────── 
   Model Type       Custom     Model with custom family                  
   Call             glm        Confirmed ~ 1 + Day                       
   Link function    log        Coefficients are in the log(y) scale      
   Distribution     Gamma      Skewed continuous distribution            
   R-squared          0.795    Proportion of reduction of error          
   AIC              257.733    Less is better                            
   Deviance          34.463    Less is better                            
   Residual DF       29.000                                              
   Converged        yes        Whether the estimation found a solution   
 ─────────────────────────────────────────────────────────────────────── 

</pre>
<p>If we look at the plot and compared the predicted values (the curve) with the actual confirmed cases (cyan dots), we can see how the model fits reasonably well the data.</p>
<figure>
<figcaption>
Figure 4. Model for Italian first 30 days
</figcaption>
<img src="gzlm_corona1_files/figure-html/intro_plot1-1.png">
</figure>
<p>In many applications our results would be considered as satisfactory, but in this case we want to do better. First, it is clear that the confirmed cases increase at a faster rate that the predicted one. Second, the model will not work for long. The number of confirmed cases cannot increase exponentialy forever, so the model will start to grossly misfit, sooner or later. Let’s fit the same model (the input is equivalent so I’m not going to show it again) for the Mainland China data, in which the outbreak happened earlier than in Italy. For Mainland China, considering the first 40 days yealds very different results as compared with Italy.</p>
<figure>
<figcaption>
Figure 4. Simple model for Mainland China, first 40 days
</figcaption>
<img src="gzlm_corona1_files/figure-html/intro_plot2-1.png">
</figure>
<p>If we look at the plot and compared the predicted values (the curve) with the actual confirmed cases (cyan dots), we can see that the model does not really fit, and cannot fit the data well. We should allow the curve to bend down, or to smooth out, in order to follow the evolution of the DV over time.</p>
Furthermore, as we can see in the recap info table, the <span class="math inline">\(R^2\)</span> is definitely not good for this kind of applications (&lt;.70)
<pre class='jamovitable'>
 Model Info                                                               
 ──────────────────────────────────────────────────────────────────────── 
   Info             Value       Comment                                   
 ──────────────────────────────────────────────────────────────────────── 
   Model Type       Custom      Model with custom family                  
   Call             glm         Confirmed ~ 1 + Day                       
   Link function    log         Coefficients are in the log(y) scale      
   Distribution     Gamma       Skewed continuous distribution            
   R-squared           0.581    Proportion of reduction of error          
   AIC              1094.366    Less is better                            
   Deviance           21.667    Less is better                            
   Residual DF        46.000                                              
   Converged        yes         Whether the estimation found a solution   
 ──────────────────────────────────────────────────────────────────────── 

</pre>
<p>The solution is polynomial regression. In polynomial regression, one adds power terms (<span class="math inline">\(x^2\)</span>, <span class="math inline">\(x^3\)</span>, <span class="math inline">\(x^4\)</span> ..) in order to allow the curve to follow different paths along the time line. A squared term, for instance, allows the curve to stay flatter at the begining and stear up quickly. A cubic term allows the curve to smooth. The more polynomial terms one adds, more flexibility one allows to the curve shape.</p>
<p>For the present data, a polynomial regression up to the 4th grade can be enough (so far). Thus, the model is now:</p>
<p><span class="math display">\[ \hat{ln(y)}=a+b_1 \cdot x + b_2 \cdot x^2, b_3 \cdot x^3+b_4 \cdot x^4\]</span></p>
<p>We now review how to run this in <span class="jamovi">jamovi</span> GAMLj.</p>
</div>
</div>
<div id="polynomial-generalized-linear-model" class="section level1">
<h1>Polynomial Generalized Linear Model</h1>
<div id="input-1" class="section level2">
<h2>Input</h2>
<p>In the input panel of GAMLj, we need to open the <code>Model</code> panel. In the <code>Components</code> fiels, upon selecting the variable <code>Day</code>, we can see a little <code>1</code> on its right.</p>
<p><img src="examples/corona/input.square.png" class="img-responsive" alt=""></p>
<p>That is the order of the term we want to include in the model. By clicking the little arrow up, we bring the order to <code>2</code>, and then drag the new term in the <code>Model Terms</code> fiels.</p>
<p>By repeating the operation for order 3 and 4, we obtained the desired model.</p>
<p><img src="examples/corona/input.full.png" class="img-responsive" alt=""></p>
</div>
</div>
<div id="output-1" class="section level1">
<h1>Output</h1>
<p>If we fit the polynomial generalized model on the data from Mainland Chine, we obtain a <span class="math inline">\(R^2\)</span> pretty close to 1, showing how well the model now fits the data. More clearly, the plot of the new model shows the flexibility of the GzLM in adjusting itself to the data trend.</p>
<pre class='jamovitable'>
 Model Info                                                                           
 ──────────────────────────────────────────────────────────────────────────────────── 
   Info             Value      Comment                                                
 ──────────────────────────────────────────────────────────────────────────────────── 
   Model Type       Custom     Model with custom family                               
   Call             glm        Confirmed ~ 1 + Day + I(Day^2) + I(Day^3) + I(Day^4)   
   Link function    log        Coefficients are in the log(y) scale                   
   Distribution     Gamma      Skewed continuous distribution                         
   R-squared          0.995    Proportion of reduction of error                       
   AIC              887.401    Less is better                                         
   Deviance           0.276    Less is better                                         
   Residual DF       43.000                                                           
   Converged        yes        Whether the estimation found a solution                
 ──────────────────────────────────────────────────────────────────────────────────── 

</pre>
<figure>
<figcaption>
Figure 4. Polynomial model for Mainland China data
</figcaption>
<img src="gzlm_corona1_files/figure-html/intro_plot3-1.png">
</figure>
<p>We can see that the model really works. But what about the Italian and French data, that were very different? Well, the model works for Italy and France as well, thanks to the model flexibility. Actually, it works well for all countries with available data. All <span class="math inline">\(R^2\)</span> are close to 1, and the predicted values are very close to the observed one. At this point, one can start working on these models and use them to extrapolate information, make comparisons, and do whaterver one usually do with statistical models.</p>
<p>The fit of the same model estimation (polynomial up to the 4th grade) is shown in the next section for all countries with more than 1000 data points.</p>
</div>
<div id="replications-across-countries" class="section level1">
<h1>Replications across countries</h1>
<p>Here are the models fitted for all available countries with more than 1000 data points. Data are update every day. The last update is 2020-03-10.</p>
<div id="australia" class="section level2">
<h2>Australia</h2>
<p><strong>R^2= 0.9853647 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-1.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                      
 ──────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower     Upper     z         p        
 ──────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)     4.51009    0.07899    90.930    77.646    105.84    57.098    < .001   
   Day             0.16079    0.03441     1.174     1.097      1.26     4.673    < .001   
   Day²            0.00282    0.00385     1.003     0.995      1.01     0.731     0.465   
   Day³           -9.79e-5    1.49e-4     1.000     1.000      1.00    -0.655     0.512   
   Day⁴           -2.69e-6    1.85e-6     1.000     1.000      1.00    -1.454     0.146   
 ──────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="france" class="section level2">
<h2>France</h2>
<p><strong>R^2= 0.9918116 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-2.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                            
 ────────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)      Lower       Upper       z         p        
 ────────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)     7.19835    0.02302    1337.225    1277.859    1398.551    312.66    < .001   
   Day             0.21427    0.01535       1.239       1.202       1.277     13.96    < .001   
   Day²           -0.01948    0.00239       0.981       0.976       0.985     -8.16    < .001   
   Day³           -0.00120    1.11e-4       0.999       0.999       0.999    -10.87    < .001   
   Day⁴           -1.67e-5    1.54e-6       1.000       1.000       1.000    -10.86    < .001   
 ────────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="germany" class="section level2">
<h2>Germany</h2>
<p><strong>R^2= 0.9945446 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-3.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                            
 ────────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)      Lower       Upper       z         p        
 ────────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)     7.12692    0.02391    1245.036    1187.673    1304.373    298.08    < .001   
   Day             0.18630    0.01627       1.205       1.167       1.244     11.45    < .001   
   Day²           -0.02489    0.00262       0.975       0.970       0.980     -9.49    < .001   
   Day³           -0.00160    1.29e-4       0.998       0.998       0.999    -12.41    < .001   
   Day⁴           -2.40e-5    1.91e-6       1.000       1.000       1.000    -12.55    < .001   
 ────────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="hong-kong" class="section level2">
<h2>Hong Kong</h2>
<p><strong>R^2= 0.9906541 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-4.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                       
 ───────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower      Upper     z         p        
 ───────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)      4.7538    0.06434    116.02    102.074    131.36    73.880    < .001   
   Day              0.0273    0.02376      1.03      0.981      1.08     1.148     0.251   
   Day²            8.85e-4    0.00250      1.00      0.996      1.01     0.354     0.723   
   Day³            5.71e-5    9.43e-5      1.00      1.000      1.00     0.606     0.545   
   Day⁴            2.90e-7    1.15e-6      1.00      1.000      1.00     0.252     0.801   
 ───────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="iran" class="section level2">
<h2>Iran</h2>
<p><strong>R^2= 0.9988269 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-5.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                            
 ────────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)      Lower       Upper       z         p        
 ────────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)      8.8801    0.01098    7187.827    7034.235    7343.745    808.40    < .001   
   Day              0.0734    0.01347       1.076       1.048       1.105      5.45    < .001   
   Day²            -0.0200    0.00451       0.980       0.972       0.989     -4.44    < .001   
   Day³            5.42e-4    5.08e-4       1.001       1.000       1.002      1.07     0.286   
   Day⁴            4.08e-5    1.76e-5       1.000       1.000       1.000      2.32     0.020   
 ────────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="italy" class="section level2">
<h2>Italy</h2>
<p><strong>R^2= 0.9981727 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-6.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                         
 ─────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)     Lower      Upper      z         p        
 ─────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)     9.12682    0.00921    9198.73    9033.83    9365.82    991.30    < .001   
   Day             0.24767    0.00778       1.28       1.26       1.30     31.85    < .001   
   Day²            0.01368    0.00167       1.01       1.01       1.02      8.20    < .001   
   Day³            0.00157    1.13e-4       1.00       1.00       1.00     13.90    < .001   
   Day⁴            3.29e-5    2.01e-6       1.00       1.00       1.00     16.39    < .001   
 ─────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="japan" class="section level2">
<h2>Japan</h2>
<p><strong>R^2= 0.9888098 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-7.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                         
 ─────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)     Lower      Upper      z         p        
 ─────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)     6.22417    0.03274    504.802    473.180    537.978    190.11    < .001   
   Day             0.04861    0.01427      1.050      1.021      1.079      3.41    < .001   
   Day²           -0.00532    0.00168      0.995      0.991      0.998     -3.16     0.002   
   Day³           -1.95e-4    6.82e-5      1.000      1.000      1.000     -2.86     0.004   
   Day⁴           -2.40e-6    8.70e-7      1.000      1.000      1.000     -2.76     0.006   
 ─────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="mainland-china" class="section level2">
<h2>Mainland China</h2>
<p><strong>R^2= 0.9957152 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-8.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                                
 ────────────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)       Lower        Upper        z          p        
 ────────────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)    11.30589    0.00239    81299.094    80919.540    81679.993    4738.02    < .001   
   Day             0.00703    8.51e-4        1.007        1.005        1.009       8.26    < .001   
   Day²            7.45e-4    8.86e-5        1.001        1.001        1.001       8.41    < .001   
   Day³            1.64e-5    3.36e-6        1.000        1.000        1.000       4.87    < .001   
   Day⁴           -9.64e-7    4.17e-8        1.000        1.000        1.000     -23.12    < .001   
 ────────────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="malaysia" class="section level2">
<h2>Malaysia</h2>
<p><strong>R^2= 0.9796269 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-9.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                      
 ──────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower      Upper     z        p        
 ──────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)      4.8885    0.06798    132.76    115.920    151.33    71.91    < .001   
   Day              0.2904    0.03173      1.34      1.256      1.42     9.15    < .001   
   Day²             0.0168    0.00363      1.02      1.010      1.02     4.63    < .001   
   Day³            4.07e-4    1.43e-4      1.00      1.000      1.00     2.84     0.004   
   Day⁴            2.97e-6    1.80e-6      1.00      1.000      1.00     1.66     0.098   
 ──────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="netherlands" class="section level2">
<h2>Netherlands</h2>
<p><strong>R^2= 0.9972888 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-10.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                         
 ─────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)     Lower      Upper     z          p        
 ─────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)      5.7654     0.0550    319.072    285.940    354.71    104.893    < .001   
   Day              0.0634     0.1166      1.065      0.847      1.34      0.544     0.587   
   Day²            -0.1245     0.0655      0.883      0.775      1.00     -1.901     0.057   
   Day³            -0.0155     0.0120      0.985      0.961      1.01     -1.285     0.199   
   Day⁴           -7.34e-4    6.80e-4      0.999      0.998      1.00     -1.080     0.280   
 ─────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="others" class="section level2">
<h2>Others</h2>
<p><strong>R^2= 0.9839325 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-11.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                      
 ──────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower     Upper     z         p        
 ──────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)     6.59043    0.02848    728.10    688.30    769.58    231.44    < .001   
   Day             0.04599    0.01449      1.05      1.02      1.08      3.17     0.002   
   Day²            0.00873    0.00214      1.01      1.00      1.01      4.08    < .001   
   Day³            4.54e-4    1.15e-4      1.00      1.00      1.00      3.96    < .001   
   Day⁴            4.06e-6    2.00e-6      1.00      1.00      1.00      2.03     0.043   
 ──────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="singapore" class="section level2">
<h2>Singapore</h2>
<p><strong>R^2= 0.9958832 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-12.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                      
 ──────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower      Upper     z        p        
 ──────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)     5.05969    0.05694    157.54    140.685    175.87    88.86    < .001   
   Day             0.09246    0.02195      1.10      1.050      1.14     4.21    < .001   
   Day²            0.00650    0.00236      1.01      1.002      1.01     2.75     0.006   
   Day³            2.13e-4    9.09e-5      1.00      1.000      1.00     2.35     0.019   
   Day⁴            1.55e-6    1.13e-6      1.00      1.000      1.00     1.37     0.171   
 ──────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="south-korea" class="section level2">
<h2>South Korea</h2>
<p><strong>R^2= 0.9947459 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-13.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                            
 ────────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)      Lower       Upper       z         p        
 ────────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)      8.8447    0.00925    6937.364    6812.467    7063.979    956.32    < .001   
   Day             -0.0731    0.00506       0.930       0.920       0.939    -14.44    < .001   
   Day²            -0.0246    7.61e-4       0.976       0.974       0.977    -32.26    < .001   
   Day³           -6.17e-4    3.77e-5       0.999       0.999       0.999    -16.36    < .001   
   Day⁴           -4.11e-6    5.36e-7       1.000       1.000       1.000     -7.67    < .001   
 ────────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="spain" class="section level2">
<h2>Spain</h2>
<p><strong>R^2= 0.9940261 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-14.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                          
 ──────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)     Lower      Upper       z         p        
 ──────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)      6.8985    0.02807    990.738    937.300    1046.322    245.77    < .001   
   Day              0.2682    0.02347      1.308      1.249       1.369     11.43    < .001   
   Day²            -0.0145    0.00465      0.986      0.977       0.995     -3.11     0.002   
   Day³           -8.02e-4    2.77e-4      0.999      0.999       1.000     -2.89     0.004   
   Day⁴           -9.26e-6    4.78e-6      1.000      1.000       1.000     -1.94     0.053   
 ──────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="switzerland" class="section level2">
<h2>Switzerland</h2>
<p><strong>R^2= 0.9960657 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-15.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                          
 ──────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)     Lower      Upper      z          p        
 ──────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)      5.9153    0.05020    370.683    335.426    408.397    117.826    < .001   
   Day             -0.0379    0.08598      0.963      0.813      1.138     -0.441     0.659   
   Day²            -0.1248    0.03997      0.883      0.815      0.954     -3.123     0.002   
   Day³            -0.0152    0.00621      0.985      0.973      0.997     -2.448     0.014   
   Day⁴           -6.65e-4    2.99e-4      0.999      0.999      1.000     -2.223     0.026   
 ──────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="taiwan" class="section level2">
<h2>Taiwan</h2>
<p><strong>R^2= 0.9901642 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-16.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                      
 ──────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower     Upper     z         p        
 ──────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)     3.78342    0.10165    43.966    35.851    53.411    37.220    < .001   
   Day            -0.03022    0.03616     0.970     0.903     1.041    -0.836     0.403   
   Day²           -0.00795    0.00366     0.992     0.985     0.999    -2.173     0.030   
   Day³           -3.20e-4    1.33e-4     1.000     0.999     1.000    -2.411     0.016   
   Day⁴           -4.22e-6    1.56e-6     1.000     1.000     1.000    -2.706     0.007   
 ──────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="thailand" class="section level2">
<h2>Thailand</h2>
<p><strong>R^2= 0.9877488 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-17.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                     
 ─────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)    Lower     Upper    z         p        
 ─────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)     3.92769    0.09456    50.789    42.021    60.88    41.536    < .001   
   Day             0.01843    0.03229     1.019     0.956     1.08     0.571     0.568   
   Day²           -0.00150    0.00314     0.998     0.992     1.00    -0.479     0.632   
   Day³           -1.18e-4    1.11e-4     1.000     1.000     1.00    -1.064     0.287   
   Day⁴           -2.24e-6    1.27e-6     1.000     1.000     1.00    -1.771     0.077   
 ─────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="uk" class="section level2">
<h2>UK</h2>
<p><strong>R^2= 0.9917477 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-18.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                         
 ─────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)     Lower      Upper      z         p        
 ─────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)     5.84501    0.04585    345.506    315.454    377.568    127.49    < .001   
   Day             0.27234    0.03161      1.313      1.234      1.397      8.62    < .001   
   Day²           -0.00740    0.00513      0.993      0.983      1.003     -1.44     0.150   
   Day³           -9.13e-4    2.67e-4      0.999      0.999      1.000     -3.43    < .001   
   Day⁴           -1.72e-5    4.25e-6      1.000      1.000      1.000     -4.04    < .001   
 ─────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
<div id="us" class="section level2">
<h2>US</h2>
<p><strong>R^2= 0.9920629 </strong></p>
<figure>
<figcaption>
</figcaption>
<img src="gzlm_corona1_files/figure-html/out-19.png">
</figure>
<pre class='jamovitable'>
 Parameter Estimates                                                                          
 ──────────────────────────────────────────────────────────────────────────────────────────── 
   Names          Estimate    SE         exp(B)     Lower      Upper     z           p        
 ──────────────────────────────────────────────────────────────────────────────────────────── 
   (Intercept)     6.48546    0.03184    655.540    615.553    697.39    203.6891    < .001   
   Day             0.29890    0.01761      1.348      1.303      1.40     16.9742    < .001   
   Day²            0.00674    0.00226      1.007      1.002      1.01      2.9849     0.003   
   Day³           -7.33e-6    9.39e-5      1.000      1.000      1.00     -0.0780     0.938   
   Day⁴           -1.60e-6    1.20e-6      1.000      1.000      1.00     -1.3317     0.183   
 ──────────────────────────────────────────────────────────────────────────────────────────── 

</pre>
</div>
</div>
<div id="the-mixed-model" class="section level1">
<h1>The mixed model</h1>
<p>When enough contries are available, variability across coefficients, and thus differences in trends, can be evaluated with the mixed model. This will be done later on.</p>
</div>
<div id="data" class="section level1">
<h1>Data</h1>
<p>Here are the data downloaded from the <a href="https://github.com/CSSEGISandData/COVID-19">CSSEGISandData</a> divided by contries. You can import them in <span class="jamovi">jamovi</span> and exercise with them.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
